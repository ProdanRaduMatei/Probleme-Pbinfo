#include <bits/stdc++.h>
using namespace std; ifstream fin("detdrum3.in"); ofstream fout("detdrum3.out"); int n , k , t[101] , val[101] , maxi , cnt , rez[101] , okee; int main() { fin >> n; for(int i = 1 ; i <= n ; i++) fin >> t[i]; for(int i = 1 ; i <= n ; i++) fin >> val[i]; for(int i = 1 ; i <= n ; i++) { int ok = 0; for(int j = 1 ; j <= n ; j++) if(t[j] == i) ok++; if(ok == 0) { int p = t[i] , s = 0; s += val[i]; while(p) { s += val[p]; p = t[p]; } if(s > maxi) maxi = s; } } fout << maxi << '\n'; for(int i = 1 ; i <= n ; i++) { int ok = 0; for(int j = 1 ; j <= n ; j++) if(t[j] == i) ok++; if(ok == 0) { int p = t[i] , s = 0; s += val[i]; while(p) { s += val[p]; p = t[p]; } if(s == maxi && okee == 0) { okee = 1; rez[++cnt] = i; int p = t[i]; while(p) rez[++cnt] = p , p = t[p]; } } } for(int i = cnt ; i >= 1 ; i--) fout << rez[i] << " "; return 0; }
